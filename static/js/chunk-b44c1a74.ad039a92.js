(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b44c1a74","chunk-2d0f0da6"],{"9daf":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("canvas",{staticStyle:{cursor:"pointer",border:"1px solid #2b2f33","background-color":"#2b2f33",position:"relative"},attrs:{id:"timeline",width:e.width,height:e.height,ondragstart:"return false;"},on:{mouseup:e.mouseupFunc,mouseout:e.mouseoutFunc,mousemove:e.mousemoveFunc,mousedown:e.mousedownFunc}})},s=[],a=(i("4160"),i("d3b7"),i("25f0"),i("159b"),{name:"time-line",props:{width:{type:String,default:"800"},height:{type:String,default:"62"},timecell:{type:Array,default:function(){return[]}}},data:function(){return{minutes_per_step:[1,2,5,10,15,20,30,60,120,180,240,360,720,1440],graduation_step:15,hours_per_ruler:24,start_timestamp:(new Date).getTime()-432e5,distance_between_gtitle:50,zoom:24,g_isMousedown:!1,g_isMousemove:!1,g_mousedownCursor:null,returnTime:null}},mounted:function(){var e=this;this.$nextTick((function(){e.canvas=document.getElementById("timeline"),e.ctx=e.canvas.getContext("2d"),e.canvasWidth=e.canvas.width,e.canvasHeight=e.canvas.height,e.init(e.start_timestamp,e.timecell,!1)}))},methods:{init:function(e,t,i){this.drawCellBg(),this.add_graduations(e),this.add_cells(t),this.drawLine(0,this.canvasHeight,this.canvasWidth,this.canvasHeight,"rgb(151, 158, 167)",1),this.drawLine(this.canvasWidth/2,0,this.canvasWidth/2,33,"rgb(64, 196, 255",2),i||this.add_events();var n=e+3600*this.hours_per_ruler*1e3/2;this.ctx.fillStyle="rgb(64, 196, 255)",this.ctx.fillText(this.changeTime(n),this.canvasWidth/2-60,50)},add_graduations:function(e){for(var t=this.canvasWidth/(60*this.hours_per_ruler),i=this.canvasWidth/(60*this.hours_per_ruler*60*1e3),n=this.graduation_step,s=n/t,a=0;a<this.minutes_per_step.length;a++)if(s<=this.minutes_per_step[a]){s=this.minutes_per_step[a],n=t*s;break}for(var r=30,o=0;o<this.minutes_per_step.length;o++)if(this.distance_between_gtitle/t<=this.minutes_per_step[o]){r=this.minutes_per_step[o];break}for(var l,u,c,m=this.canvasWidth/n,h=this.ms_to_next_step(e,60*s*1e3),d=h*i,_=n/i,g=0;g<m;g++){l=d+g*n,u=e+h+g*_;var p=new Date(u);if(0===p.getUTCHours()&&0===p.getUTCMinutes()){c=25;var v=this.graduation_title(p);this.ctx.fillText(v,l-20,30),this.ctx.fillStyle="rgba(151,158,167,1)"}else if(u/6e4%r===0){c=15;var f=this.graduation_title(p);this.ctx.fillText(f,l-20,30),this.ctx.fillStyle="rgba(151,158,167,1)"}else c=10;this.drawLine(l,0,l,c,"rgba(151,158,167,1)",1)}},drawLine:function(e,t,i,n,s,a){this.ctx.beginPath(),this.ctx.moveTo(e,t),this.ctx.lineTo(i,n),this.ctx.strokeStyle=s,this.ctx.lineWidth=a,this.ctx.stroke()},add_cells:function(e){var t=this;e.forEach((function(e){t.draw_cell(e)}))},draw_cell:function(e){var t=this,i=t.canvasWidth/(60*t.hours_per_ruler*60*1e3),n=(e.beginTime-t.start_timestamp)*i,s=(e.endTime-e.beginTime)*i;t.ctx.fillStyle=e.style.background,t.ctx.fillRect(n,0,s,15)},drawCellBg:function(){this.ctx.fillStyle="rgba(69, 72, 76, 0.5)",this.ctx.fillRect(0,0,this.canvasWidth,15)},add_events:function(){var e=this;e.canvas.addEventListener&&e.canvas.addEventListener("mousewheel",e.mousewheelFunc.bind(e))},mousedownFunc:function(e){this.g_isMousedown=!0,this.g_mousedownCursor=this.get_cursor_x_position(e,!0)},mousemoveFunc:function(e){var t=this,i=t.get_cursor_x_position(e,!0),n=t.canvasWidth/(60*t.hours_per_ruler*60*1e3);if(t.clearCanvas(),t.g_isMousedown){var s=i-t.g_mousedownCursor;t.start_timestamp=t.start_timestamp-Math.round(s/n),t.init(t.start_timestamp,t.timecell,!0),t.g_isMousemove=!0,t.g_mousedownCursor=i}else{var a=t.start_timestamp+i/n;t.init(t.start_timestamp,t.timecell,!0),t.drawLine(i,0,i,50,"rgb(194, 202, 215)",1),t.ctx.fillStyle="rgb(194, 202, 215)",t.ctx.fillText(t.changeTime(a),i-50,60)}},mouseupFunc:function(e){var t=this;if(t.g_isMousemove)t.g_isMousemove=!1,t.g_isMousedown=!1,t.returnTime=t.start_timestamp+3600*t.hours_per_ruler*1e3/2;else{t.g_isMousedown=!1;var i=t.get_cursor_x_position(e,!0),n=3600*t.zoom*1e3/t.canvasWidth;t.returnTime=t.start_timestamp+i*n,t.set_time_to_middle(t.returnTime)}this.$emit("mouseupFunc",t.returnTime)},mouseoutFunc:function(){var e=this;e.clearCanvas(),e.init(e.start_timestamp,e.timecell,!0)},mousewheelFunc:function(e){var t=this;if(!e||!e.preventDefault)return window.event.returnValue=!1,!1;e.preventDefault();var i=window.event||e,n=Math.max(-1,Math.min(1,i.wheelDelta||-i.detail)),s=t.start_timestamp+3600*t.hours_per_ruler*1e3/2;n<0?(t.zoom=t.zoom+4,t.zoom>=24&&(t.zoom=24),t.hours_per_ruler=t.zoom):n>0&&(t.zoom=t.zoom-4,t.zoom<=1&&(t.zoom=1),t.hours_per_ruler=t.zoom),t.clearCanvas(),t.start_timestamp=s-3600*t.hours_per_ruler*1e3/2,t.init(t.start_timestamp,t.timecell,!0)},get_cursor_x_position:function(e,t){var i=0;return e||(e=window.event),t?i=e.offsetX:e.pageX||e.pageY?i=e.pageX:(e.clientX||e.clientY)&&(i=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft),i},graduation_title:function(e){return 0===e.getHours()&&0===e.getMinutes()&&0===e.getMilliseconds()?("0"+e.getDate().toString()).substr(-2)+"."+("0"+(e.getMonth()+1).toString()).substr(-2)+"."+e.getFullYear():e.getHours()+":"+("0"+e.getMinutes().toString()).substr(-2)},ms_to_next_step:function(e,t){var i=e%t;return i?t-i:0},set_time_to_middle:function(e){this.clearCanvas(),this.start_timestamp=e-60*this.hours_per_ruler*60*1e3/2,this.init(this.start_timestamp,this.timecell,!0)},returnMouseupTime:function(e){var t=this;null!=t.returnTime&&e&&e(t.returnTime)},clearCanvas:function(){this.ctx.clearRect(0,0,1500,150)},changeTime:function(e){var t=new Date(e),i=t.getFullYear(),n=t.getMonth()+1;n<10&&(n="0"+n);var s=t.getDate();s<10&&(s="0"+s);var a=t.getHours();a<10&&(a="0"+a);var r=t.getMinutes();r<10&&(r="0"+r);var o=t.getSeconds();return o<10&&(o="0"+o),i+"-"+n+"-"+s+" "+a+":"+r+":"+o},play:function(e){this.set_time_to_middle(e)},loadVideoClip:function(e,t,i){this.clearCanvas(),this.init(e,t,i)}}}),r=a,o=i("2877"),l=Object(o["a"])(r,n,s,!1,null,null,null);t["default"]=l.exports},a5dc:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("container",[i("time-line",{ref:"timeLine",attrs:{timecell:e.timecell},on:{mouseupFunc:e.mouseupFunc}}),i("el-row",{staticStyle:{"margin-top":"40px"}},[i("el-button",{on:{click:e.play}},[e._v("播放")]),i("el-button",{on:{click:e.stop}},[e._v("停止播放")]),i("el-button",{on:{click:e.handleTimecell}},[e._v("切换视频片段")]),i("el-date-picker",{staticStyle:{"margin-left":"20px"},attrs:{type:"date",placeholder:"查看某天视频片段"},on:{change:e.changeDateTimeline},model:{value:e.value1,callback:function(t){e.value1=t},expression:"value1"}})],1),i("p",[e._v("当前播放时间："+e._s(this.playVal))])],1)},s=[],a=i("9daf"),r={components:{TimeLine:a["default"]},data:function(){return{value1:"",playVal:"",timecell:[{beginTime:(new Date).getTime()-108e5,endTime:(new Date).getTime()-36e5,style:{background:"rgba(132, 244, 180, 0.498039)"}},{beginTime:(new Date).getTime()-216e5,endTime:(new Date).getTime()-144e5,style:{background:"rgba(132, 244, 180, 0.498039)"}}],timer:null}},methods:{play:function(){var e=this;console.log("zlm333"),this.timer=setInterval((function(){e.$refs.timeLine.play((new Date).getTime())}),1e3)},stop:function(){clearInterval(this.timer)},handleTimecell:function(){this.timecell=[{beginTime:(new Date).getTime()-144e5,endTime:(new Date).getTime()-36e5,style:{background:"rgba(132, 244, 180, 0.498039)"}}];var e=(new Date).getTime()-432e5;this.$refs.timeLine.loadVideoClip(e,this.timecell,!1)},changeDateTimeline:function(e){console.log(e),this.$refs.timeLine.play(new Date(e).getTime())},mouseupFunc:function(e){console.log(e),this.playVal=e}}},o=r,l=i("2877"),u=Object(l["a"])(o,n,s,!1,null,null,null);t["default"]=u.exports}}]);