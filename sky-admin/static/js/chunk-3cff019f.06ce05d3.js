(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3cff019f"],{bc33:function(e,t,o){},c02a:function(e,t,o){"use strict";o("bc33")},cc4c:function(e,t,o){"use strict";o.r(t);var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-main",{staticClass:"el-main"},[o("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[o("el-row",[o("el-col",{attrs:{span:4}},[o("el-form-item",{attrs:{label:"添加列名",prop:"columnKey"}},[o("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"请输入内容"},model:{value:e.ruleForm.columnKey,callback:function(t){e.$set(e.ruleForm,"columnKey",t)},expression:"ruleForm.columnKey"}})],1)],1),o("el-col",{attrs:{span:8}},[o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addColumn("ruleForm")}}},[e._v("添加列")]),o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("添加行")])],1)],1)],1)],1),o("el-dialog",{attrs:{title:"添加行",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[o("el-form",{ref:"ruleForm",attrs:{model:e.addForm,rules:e.addFormRules}},[o("el-form-item",{attrs:{label:"类型","label-width":"80px",prop:"type"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择类型"},on:{change:e.changeType},model:{value:e.addForm.type,callback:function(t){e.$set(e.addForm,"type",t)},expression:"addForm.type"}},e._l(e.TypeOptions,(function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),o("el-form-item",{attrs:{label:"格式","label-width":"80px"}},[o("el-input",{attrs:{type:"textarea",rows:4,placeholder:"内容格式"},model:{value:e.addForm.format,callback:function(t){e.$set(e.addForm,"format",t)},expression:"addForm.format"}})],1),o("el-form-item",{attrs:{label:"内容","label-width":"80px",prop:"coordinates"}},[o("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入内容"},model:{value:e.addForm.coordinates,callback:function(t){e.$set(e.addForm,"coordinates",t)},expression:"addForm.coordinates"}})],1)],1),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addrow("ruleForm")}}},[e._v("确 定")])],1)],1),o("el-table",{staticClass:"tb-edit",staticStyle:{width:"100%"},attrs:{border:"",data:e.geoData,height:e.tableHeight,stripe:""}},[o("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[o("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[o("el-row",[o("el-col",{attrs:{span:8}},[o("el-form-item",{attrs:{label:"经度"}},[o("span",[e._v(e._s(r.geometry.coordinates[0]))])])],1),o("el-col",{attrs:{span:8}},[o("el-form-item",{attrs:{label:"纬度"}},[o("span",[e._v(e._s(r.geometry.coordinates[1]))])])],1),o("el-col",{attrs:{span:8}},[o("el-form-item",{attrs:{label:"海拔"}},[o("span",[e._v(e._s(r.geometry.coordinates[2]))])])],1)],1)],1)]}}])}),e._l(e.geoHeader,(function(t,r){return[t.property?o("el-table-column",{key:r,attrs:{label:t.property,property:t.property,"render-header":e.renderHeader},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input",{on:{blur:function(o){return e.focus(t.row[t.column.property],t.column.property)}},model:{value:t.row[t.column.property],callback:function(o){e.$set(t.row,t.column.property,o)},expression:"scope.row[scope.column.property]"}})]}}],null,!0)}):e._e()]})),e.geoHeader.length>0?o("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-edit"},on:{click:function(o){return e.deleteRow(t.$index,e.geoData)}}},[e._v("删除")])]}}],null,!1,1207825992)}):e._e()],2),o("el-button",{staticStyle:{"margin-top":"20px"},on:{click:e.commit}},[e._v("提交")])],1)},a=[];o("99af"),o("4de4"),o("c740"),o("4160"),o("c975"),o("d81d"),o("a434"),o("d3b7"),o("6062"),o("3ca3"),o("159b"),o("ddb0"),o("a4d3"),o("b64b");function n(e,t){if(null==e)return{};var o,r,a={},n=Object.keys(e);for(r=0;r<n.length;r++)o=n[r],t.indexOf(o)>=0||(a[o]=e[o]);return a}function i(e,t){if(null==e)return{};var o,r,a=n(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)o=i[r],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}var l=o("ade3"),s=o("2909"),c=o("5530"),p={type:"FeatureCollection",features:[{type:"Feature",properties:{id:1,Name:"停机坪1",age:11},geometry:{type:"Point",coordinates:[116.42211914057,40.38839687388361,415]}},{type:"Feature",properties:{id:2,Name:"停机坪2",age:12},geometry:{type:"Point",coordinates:[116.1996459961,40.40513069752789,415]}},{type:"Feature",properties:{id:3,Name:"停机坪3",age:13},geometry:{type:"Point",coordinates:[116.9604492188,40.413496049701955,415]}}]},u={name:"material-block-table-geoJson-table",data:function(){return{tableHeight:650,geoJson:p,TypeOptions:[{value:"Point",label:"点——Point"},{value:"LineString",label:"线——LineString"},{value:"Polygon",label:"多边形——Polygon"}],ruleForm:{columnKey:""},addForm:{type:"",coordinates:null,format:""},dialogFormVisible:!1,geoData:[],geoHeader:[],checkedList:[],rules:{columnKey:[{required:!0,message:"请输入列名",trigger:"blur"},{pattern:/^[a-zA-Z]+$/,message:"只能输入英文",trigger:"blur"}]},addFormRules:{coordinates:[{required:!0,message:"请输入内容",trigger:"blur"}],type:[{required:!0,message:"请选择类型",trigger:"change"}]}}},mounted:function(){this.initJeoJson()},methods:{initJeoJson:function(){var e=this;for(var t in this.geoHeader=[],this.geoData=[],p.features.map((function(t,o){e.geoData.push(Object(c["a"])(Object(c["a"])({},t.properties),{},{geometry:{type:t.geometry.type,coordinates:t.geometry.coordinates}}))})),this.geoData=Object(s["a"])(this.geoData),p.features[0].properties)this.geoHeader.push({property:t})},addColumn:function(e){var t=this;this.dialogFormVisible=!0;var o=this.ruleForm.columnKey,r=!1;this.$refs[e].validate((function(e){if(!e)return t.$message({type:"error",message:"列名只能为英文"}),!1;t.geoData.forEach((function(e){r=!!e.hasOwnProperty(o)})),r?t.$message({type:"error",message:"".concat(o,"已存在请重新添加")}):(t.geoData=t.geoData.map((function(e){return Object(c["a"])(Object(c["a"])({},e),{},Object(l["a"])({},t.ruleForm.columnKey,""))})),t.geoHeader.push({property:t.ruleForm.columnKey}),t.$message({type:"success",message:"添加成功"}))}))},changeType:function(e){switch(e){case"Point":this.addForm.format="[116.9604492188,40.413496049701955,415]";break;case"LineString":this.addForm.format="[\n          [\n            115.98129272460936,\n            40.587885288417915\n          ],\n          [\n            116.3067626953125,\n            40.561807971278185\n          ],\n          [\n            116.01150512695312,\n            40.43649540640561\n          ],\n          [\n            115.98129272460936,\n            40.58162765924269\n          ]\n        ]";break;case"Polygon":this.addForm.format=" [\n          [\n            [\n              116.553955078125,\n              40.617079816381285\n            ],\n            [\n              116.81900024414062,\n              40.617079816381285\n            ],\n            [\n              116.81900024414062,\n              40.749337730454826\n            ],\n            [\n              116.553955078125,\n              40.749337730454826\n            ],\n            [\n              116.553955078125,\n              40.617079816381285\n            ]\n          ]\n        ]";break;default:break}},addrow:function(e){var t=this,o=JSON.parse(JSON.stringify(this.geoData[0]));this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;var r={},a=o.geometry,n=i(o,["geometry"]);for(var l in n)r[l]="";var s=JSON.parse(t.addForm.coordinates);r.geometry=a,r.geometry.type=t.addForm.type,r.geometry.coordinates=s,t.geoData.push(r),t.dialogFormVisible=!1}))},deleteRow:function(e,t){t.splice(e,1)},commit:function(){var e=[],t=this.checkedList.filter((function(e){return!0===e.state}));this.geoData.map((function(o){t.map((function(t){e.push(o[t.key]+t.key)}))}));var o=this.geoData.map((function(e){return String(e.id)})),r=[].concat(e,Object(s["a"])(o));if(new Set(r).size!==r.length)this.$message({type:"error",message:"有重复项,不可以提交"});else{var a={},n=(p.features.map((function(e){return Object(c["a"])({},e.geometry)})),this.geoData.map((function(e,t){e.geometry;var o=i(e,["geometry"]);return{type:"Feature",geometry:{type:e.geometry.type,coordinates:e.geometry.coordinates},properties:o}})));n.length&&(a.type=p.type,a.features=n,console.log(JSON.stringify(a)),this.initJeoJson())}},renderHeader:function(e,t){var o=this,r=t.column;return e("div",[e("span",r.label),"id"!==r.property&&"Name"!==r.property&&e("el-button",{style:"margin-left:20px",props:{type:"primary",size:"small",icon:"el-icon-edit"},on:{click:function(){o.modification(r)}}}),"id"!==r.property&&"Name"!==r.property&&e("el-button",{props:{type:"danger",size:"small",icon:"el-icon-delete"},on:{click:function(){o.delete(r)}}}),e("el-checkbox",{style:"margin-left: 20px;",props:{checked:"id"===r.property,disabled:"id"===r.property},on:{change:function(e){o.change(e,r)}}},"验证")])},change:function(e,t){var o=t.property,r=this.checkedList.findIndex((function(e){return e.key===o}));-1===r?this.checkedList.push({key:o,state:e}):this.checkedList.forEach((function(t){t.key===o&&(t.state=e)}))},modification:function(e){var t=this;this.$prompt("是否要修改【".concat(e.property,"】字段"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^[a-zA-Z]+$/,inputErrorMessage:"内容只能为字母"}).then((function(o){var r=o.value;if(""!==r){for(var a=0;a<t.geoData.length;a++)for(var n in t.geoData[a])n===e.property&&(t.geoData[a][r]=t.geoData[a][n],delete t.geoData[a][n]);t.geoHeader.map((function(t){t.property===e.property&&(t.property=r)})),t.$message({type:"success",message:"修改成功"})}})).catch((function(){t.$message({type:"info",message:"取消修改"})}))},focus:function(e,t){var o=this;if("id"===t){var r=this.geoData.map((function(e){return String(e[t])}));new Set(r).size!==r.length&&r.forEach((function(e,t){r.indexOf(e)!==t&&setTimeout((function(){o.$message({type:"error",message:"当前列".concat(t+1,"行有重复项")})}),200)}))}},delete:function(e){var t=this,o=e.property;this.$confirm("是否要删除当前列","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.geoData.forEach((function(e){for(var t in e)delete e[o]})),t.geoData=Object(s["a"])(t.geoData),t.geoHeader.map((function(t){t.property===e.property&&delete t.property})),t.$message({type:"success",message:"删除成功!"})})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))}}},m=u,d=(o("c02a"),o("2877")),f=Object(d["a"])(m,r,a,!1,null,"67bb55f4",null);t["default"]=f.exports}}]);